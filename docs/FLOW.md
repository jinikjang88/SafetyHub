## 산업현장 통합 안전 시나리오

SafetyKit + LifeGuard + 관제 시스템이 연동되어 통합 안전 관제를 실현합니다.

---

## 시나리오: 작업자 응급상황 대응

### 상황 설정

- 👷 작업자: LifeGuard Band 착용 중
- ⚙️ 설비: SafetyKit 연결된 프레스 기계 작업 중
- 상황: 작업 중 작업자 쓰러짐

### 대응 플로우

| 단계 | 시간 | 시스템 | 동작 |
| --- | --- | --- | --- |
| 1. 감지 | 0초 | LifeGuard Band | 심박/자세 이상 감지 |
| 2. 분석 | 1초 | SafetyHub Server | AI 분석 - 위험 판정 |
| 3. 설비 정지 | 2초 | SafetyKit | 해당 구역 설비 자동 정지 |
| 4. 1차 확인 | 3초 | 스마트폰 App | "괜찮으세요?" 알림 (10초 카운트) |
| 5. 자동 신고 | 13초 | SafetyHub Server | 🚨 119 자동 신고 |
| 6. 정보 전송 | 14초 | SafetyHub Server | 📍 GPS 위치 + 📊 바이탈 + 👤 신원 전송 |
| 7. 보호자 알림 | 15초 | SafetyHub Server | 👨‍👩‍👧 보호자 알림 + 위치 공유 |

**⏱️ 감지부터 대응까지: < 15초**

---

## 시나리오: 설비 이상 감지

### 상황 설정

- ⚙️ 설비: SafetyKit 연결된 CNC 기계
- 상황: 전류 패턴 이상 감지 (베어링 마모 의심)

### 대응 플로우

| 단계 | 시스템 | 동작 |
| --- | --- | --- |
| 1. 감지 | SafetyKit | 전류 패턴 이상 감지 (CT 센서) |
| 2. 분석 | SafetyHub Server | AI 예측 분석 - 72시간 내 고장 확률 85% |
| 3. 알림 | SafetyHub Server | 정비팀 알림 - "베어링 마모 의심, 점검 권장" |
| 4. 자동 조치 | SafetyHub Server | 예비 부품 자동 발주 |
| 5. 스케줄 조정 | SafetyHub Server | 작업 스케줄 자동 조정 |

---

## 시나리오: 작업자 안전구역 접근

### 상황 설정

- 👷 작업자: 작동 중인 프레스 기계에 접근
- ⚙️ 설비: SafetyKit 연결된 프레스 기계

### 대응 플로우

| 단계 | 시간 | 시스템 | 동작 |
| --- | --- | --- | --- |
| 1. 감지 | 0ms | SafetyKit | PIR/초음파 센서 - 작업자 접근 감지 |
| 2. 로컬 판단 | 1ms | SafetyKit (Edge) | 안전 거리 위반 판단 |
| 3. 즉시 정지 | 5ms | SafetyKit | **Hot Path** - 설비 즉시 정지 |
| 4. 경고 | 10ms | SafetyKit | 경고음 + LED 경고 |
| 5. 서버 보고 | 100ms | SafetyHub Server | 이벤트 기록 |

**⏱️ 감지부터 정지까지: < 10ms (Hot Path)**

---

## 시나리오: 환경 위험 감지 (확장)

### 상황 설정

- 🏭 환경: 고온 작업 환경 (40°C 이상)
- 👷 작업자: LifeGuard Band 착용
- ⚙️ 설비: SafetyKit Pro+ (환경 센서 탑재)

### 대응 플로우

| 단계 | 시스템 | 감지 내용 |
| --- | --- | --- |
| 1. 환경 감지 | SafetyKit Pro+ | 온도 40°C 초과 |
| 2. 생체 감지 | LifeGuard Band | 심박 상승 (120bpm → 150bpm) |
| 3. 복합 분석 | SafetyHub Server | "고온 환경 + 심박 상승" = **열사병 위험** |
| 4. 예방 조치 | SafetyHub Server | 작업자 휴식 알림 + 관리자 경고 |

---

## 로봇 시뮬레이션 시나리오

> 📄 상세 문서: [ROBOT_SIMULATION.md](ROBOT_SIMULATION.md)

실제 작업자 투입 전, 로봇 더미를 활용하여 SafetyHub 시스템을 사전 검증합니다.

### 시나리오: 화재 발생 대피 시뮬레이션

```
┌──────────────────────────────────────────────────────────────────┐
│  시뮬레이션 환경: 500대 로봇, 8개 구역                            │
├──────────────────────────────────────────────────────────────────┤
│                                                                    │
│  [0:00] 🔥 Zone C 화재 감지 (SafetyKit 온도/연기 센서)            │
│         │                                                          │
│         ▼                                                          │
│  [0:01] 🚨 긴급 알림 발송                                         │
│         ├── 대시보드: 화재 경보 표시                               │
│         ├── Zone C 로봇: 즉시 대피 명령                            │
│         └── 인접 구역: 대피 준비 알림                              │
│         │                                                          │
│         ▼                                                          │
│  [0:02] 🚶 대피 시작                                              │
│         ├── Zone C → Zone H (대피소)                              │
│         ├── A* 경로 탐색: 최단 대피 경로 계산                      │
│         └── 실시간 위치 추적                                       │
│         │                                                          │
│         ▼                                                          │
│  [0:05] 📞 119 자동 신고 (CRITICAL 레벨)                          │
│         ├── Emergency119ApiClient 호출                             │
│         └── 위치/상황 정보 전송                                    │
│         │                                                          │
│         ▼                                                          │
│  [0:10] ✅ 대피 완료 확인                                         │
│         ├── Zone H 집결 인원 카운트                                │
│         └── 미대피자 추적 및 알림                                  │
│                                                                    │
└──────────────────────────────────────────────────────────────────┘

검증 항목:
├── 긴급 알림 전달 시간: < 3초
├── 119 자동 신고: < 5분
├── 전원 대피 완료: < 10분
└── 인원 파악 정확도: 100%
```

### 시나리오: 낙상 감지 시뮬레이션

```
┌──────────────────────────────────────────────────────────────────┐
│  시뮬레이션 환경: 100대 로봇, Zone A 작업장                       │
├──────────────────────────────────────────────────────────────────┤
│                                                                    │
│  [0:00.000] 📉 Robot #42 가속도계 급격한 변화 감지                │
│             │  (LifeGuard 시뮬레이션 - 낙상 패턴)                  │
│             ▼                                                      │
│  [0:00.100] 🔴 HealthStatus: NORMAL → DANGER                      │
│             │                                                      │
│             ▼                                                      │
│  [0:00.200] ⚡ Hot Path 긴급 처리                                  │
│             │  EmergencyDetectedEvent (Priority: CRITICAL)        │
│             ▼                                                      │
│  [0:01.000] 📢 주변 로봇 알림                                     │
│             │  반경 50m 내 로봇에 경고                             │
│             ▼                                                      │
│  [0:02.000] 📺 대시보드 실시간 표시                               │
│             │  WebSocket STOMP 알림                                │
│             ▼                                                      │
│  [0:03.000] 🏥 의무실(Zone G) 알림                                │
│                                                                    │
└──────────────────────────────────────────────────────────────────┘

검증 항목:
├── 낙상 감지 시간: < 1초
├── Hot Path 처리: < 100ms
├── 주변 알림 전달: < 2초
└── 대시보드 표시: < 3초
```

### 시나리오: 부하 테스트 시뮬레이션

```
┌──────────────────────────────────────────────────────────────────┐
│  시뮬레이션 환경: 10,000대 로봇, 1시간 연속 운영                  │
├──────────────────────────────────────────────────────────────────┤
│                                                                    │
│  이벤트 발생 패턴:                                                 │
│  ├── 초당 10,000 위치 업데이트                                    │
│  ├── 초당 1,000 센서 데이터                                       │
│  ├── 초당 100 상태 변경                                           │
│  └── 초당 10 긴급 이벤트                                          │
│                                                                    │
│  모니터링 메트릭:                                                  │
│  ┌─────────────────────────────────────────────────────────────┐  │
│  │  응답 시간: ████████░░ 평균 45ms / 99th 120ms               │  │
│  │  처리량:   ██████████ 12,000 TPS                            │  │
│  │  CPU:     ████████░░ 65%                                    │  │
│  │  메모리:  ██████░░░░ 4.2GB / 8GB                            │  │
│  │  데이터 손실: 0건                                            │  │
│  └─────────────────────────────────────────────────────────────┘  │
│                                                                    │
└──────────────────────────────────────────────────────────────────┘

검증 항목:
├── 평균 응답 시간: < 100ms
├── 99th percentile: < 500ms
├── 데이터 손실: 0%
└── CPU 사용률: < 70%
```

---

## 데이터 흐름

### 수집 데이터

| 소스 | 데이터 유형 | 주기 |
| --- | --- | --- |
| SafetyKit | 전류, 온도, 모션, 거리 | 100ms |
| LifeGuard | 심박, PPG, 가속도, 온도 | 50ms |
| Robot Simulator | 위치, 상태, 배터리 | 100ms |

### 저장 경로

| 데이터 유형 | 저장소 | 보존 기간 |
| --- | --- | --- |
| 실시간 상태 | Redis | 실시간 |
| 이벤트 로그 | Kafka → MySQL | 90일 |
| 집계 통계 | MySQL | 영구 |
| 알림 이력 | MySQL | 1년 |

---

## 리포팅 항목

### 실시간 대시보드

- 현장별 설비 상태 현황
- 작업자 생체 신호 현황
- 경고/사고 발생 현황

### 주간/월간 리포트

- 안전 지표 대시보드
- 아차사고 통계
- 설비 예방정비 현황
- 작업자 건강 통계

### 법적 리포트

- 산업안전보건법 준수 현황
- 사고 이력 기록
- 안전 교육 이수 현황

---

**문서 버전:** v1.1

**최종 수정:** 2026-01-13