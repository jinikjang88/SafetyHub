# Phase 2 ì§„í–‰ ìƒí™© ê¸°ë¡

> **ì‘ì—… ê¸°ê°„:** 2026-01-16 ~
> **ëª©í‘œ:** Control System êµ¬ì¶• (Unified Gateway, Event Pipeline, Task Dispatch)

---

## ğŸ“‹ Phase 2 ê°œìš”

Phase 2ëŠ” SafetyHubì˜ í•µì‹¬ ê´€ì œ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤.

### ì£¼ìš” ëª©í‘œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Phase 2 Architecture                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚   MQTT    â”‚  â”‚ WebSocket â”‚  â”‚   REST    â”‚                   â”‚
â”‚  â”‚  (Device) â”‚  â”‚  (Robot)  â”‚  â”‚   (API)   â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                       â”‚                                          â”‚
â”‚                       â–¼                                          â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚          â”‚   Unified Gateway      â”‚  â† ë©€í‹° í”„ë¡œí† ì½œ í†µí•©       â”‚
â”‚          â”‚   (Message Router)     â”‚                             â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                       â”‚                                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚         â”‚             â”‚             â”‚                            â”‚
â”‚         â–¼             â–¼             â–¼                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚    â”‚ğŸ”´ Hot  â”‚   â”‚ğŸŸ¡ Warm  â”‚   â”‚ğŸ”µ Cold â”‚                       â”‚
â”‚    â”‚< 10ms  â”‚   â”‚< 500ms  â”‚   â”‚ Async  â”‚                       â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚    â€¢ ê¸´ê¸‰ì •ì§€    â€¢ íƒœìŠ¤í¬ë¶„ë°°   â€¢ ë¡œê·¸ì €ì¥                        â”‚
â”‚    â€¢ ì¶©ëŒíšŒí”¼    â€¢ ê²½ë¡œê³„ì‚°     â€¢ í†µê³„ë¶„ì„                        â”‚
â”‚    â€¢ 119ì‹ ê³      â€¢ ì•Œë¦¼ë°œì†¡     â€¢ ë¦¬í¬íŒ…                          â”‚
â”‚                                                                  â”‚
â”‚                       â–¼                                          â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚          â”‚   Event Stream (Kafka) â”‚                             â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                       â”‚                                          â”‚
â”‚                       â–¼                                          â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚          â”‚   State Cache (Redis)  â”‚                             â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š ì‘ì—… ì²´í¬ë¦¬ìŠ¤íŠ¸

### Week 5-6: Command Processing (ì´ë²¤íŠ¸ ì²˜ë¦¬)

#### 1ï¸âƒ£ Unified Gateway êµ¬í˜„
- [ ] **Gateway ì¸í„°í˜ì´ìŠ¤ ì„¤ê³„**
  - [ ] ProtocolAdapter ì¸í„°í˜ì´ìŠ¤ ì •ì˜
  - [ ] Message í†µí•© ëª¨ë¸ ì„¤ê³„
  - [ ] Gateway ë¼ìš°íŒ… ë¡œì§ êµ¬í˜„

- [ ] **ë©€í‹° í”„ë¡œí† ì½œ ì–´ëŒ‘í„° êµ¬í˜„**
  - [ ] MQTT Adapter (IoT ì¥ì¹˜)
  - [ ] WebSocket Adapter (ì‹¤ì‹œê°„ í†µì‹ )
  - [ ] REST Adapter (API í˜¸ì¶œ)
  - [ ] Simulator Adapter (ì‹œë®¬ë ˆì´í„°)

#### 2ï¸âƒ£ ì´ë²¤íŠ¸ ìˆ˜ì§‘ íŒŒì´í”„ë¼ì¸
- [ ] **Kafka Producer êµ¬í˜„**
  - [ ] ì´ë²¤íŠ¸ ë°œí–‰ ì„œë¹„ìŠ¤
  - [ ] í† í”½ êµ¬ì¡° ì„¤ê³„
  - [ ] ì§ë ¬í™”/ì—­ì§ë ¬í™” ì„¤ì •

- [ ] **Kafka Consumer êµ¬í˜„**
  - [ ] ì´ë²¤íŠ¸ ì†Œë¹„ì ê·¸ë£¹ ì„¤ì •
  - [ ] ì—ëŸ¬ í•¸ë“¤ë§ ë° ì¬ì‹œë„
  - [ ] DLQ (Dead Letter Queue) êµ¬í˜„

#### 3ï¸âƒ£ Hot/Warm/Cold Path ë¶„ë¦¬
- [ ] **Hot Path (< 10ms)**
  - [ ] ê¸´ê¸‰ ì •ì§€ ì²˜ë¦¬
  - [ ] ì¶©ëŒ íšŒí”¼ ë¡œì§
  - [ ] 119 ìë™ ì‹ ê³ 
  - [ ] In-Memory ì²˜ë¦¬ (Redis)

- [ ] **Warm Path (< 500ms)**
  - [ ] íƒœìŠ¤í¬ ë¶„ë°° ë¡œì§
  - [ ] ê²½ë¡œ ê³„ì‚° (A* í™œìš©)
  - [ ] ì•Œë¦¼ ë°œì†¡
  - [ ] DB ì¡°íšŒ/ì—…ë°ì´íŠ¸

- [ ] **Cold Path (ë¹„ë™ê¸°)**
  - [ ] ë¡œê·¸ ì €ì¥ (Kafka â†’ DB)
  - [ ] í†µê³„ ë¶„ì„
  - [ ] ë¦¬í¬íŒ…
  - [ ] ë°°ì¹˜ ì²˜ë¦¬

#### 4ï¸âƒ£ Redis ìƒíƒœ ìºì‹œ
- [ ] **Redis ìºì‹œ êµ¬ì¡° ì„¤ê³„**
  - [ ] í‚¤ ë„¤ì´ë° ì „ëµ
  - [ ] TTL ì •ì±… ìˆ˜ë¦½
  - [ ] ìºì‹œ ë¬´íš¨í™” ì „ëµ

- [ ] **ìºì‹œ ë ˆì´ì–´ êµ¬í˜„**
  - [ ] Robot ìƒíƒœ ìºì‹±
  - [ ] Zone ìƒíƒœ ìºì‹±
  - [ ] Device ìƒíƒœ ìºì‹±
  - [ ] ìºì‹œ ì—…ë°ì´íŠ¸ ë¦¬ìŠ¤ë„ˆ

#### 5ï¸âƒ£ Kafka ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼
- [ ] **í† í”½ ì„¤ê³„**
  - [ ] `robot.events` - ë¡œë´‡ ì´ë²¤íŠ¸
  - [ ] `device.events` - ì¥ì¹˜ ì´ë²¤íŠ¸
  - [ ] `worker.events` - ì‘ì—…ì ì´ë²¤íŠ¸
  - [ ] `emergency.events` - ê¸´ê¸‰ ì´ë²¤íŠ¸

- [ ] **ì´ë²¤íŠ¸ ìŠ¤í‚¤ë§ˆ ì •ì˜**
  - [ ] EventEnvelope ê³µí†µ êµ¬ì¡°
  - [ ] ë„ë©”ì¸ë³„ ì´ë²¤íŠ¸ íƒ€ì…
  - [ ] Avro/JSON Schema

---

### Week 7-8: Task Dispatch (ì‘ì—… ë¶„ë°°)

#### 6ï¸âƒ£ ë¶„ë°° ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„
- [ ] **ì‘ì—… í ê´€ë¦¬**
  - [ ] Priority Queue êµ¬í˜„
  - [ ] Task Entity ëª¨ë¸
  - [ ] ìš°ì„ ìˆœìœ„ ì •ì±…

- [ ] **ë¶„ë°° ì „ëµ**
  - [ ] Round-Robin ë¶„ë°°
  - [ ] Load-Based ë¶„ë°°
  - [ ] Location-Based ë¶„ë°°
  - [ ] Skill-Based ë¶„ë°°

#### 7ï¸âƒ£ ê²½ë¡œ ê³„íš í†µí•©
- [ ] **PathFinder ì„œë¹„ìŠ¤í™”**
  - [ ] PathPlanning UseCase (ì´ë¯¸ A* êµ¬í˜„ë¨)
  - [ ] ê²½ë¡œ ìµœì í™”
  - [ ] ë™ì  ì¥ì• ë¬¼ íšŒí”¼

- [ ] **ê²½ë¡œ ìºì‹±**
  - [ ] ìì£¼ ì‚¬ìš©í•˜ëŠ” ê²½ë¡œ ìºì‹±
  - [ ] ê²½ë¡œ ì¬ì‚¬ìš© ë¡œì§

#### 8ï¸âƒ£ ì¶©ì „ ìŠ¤ì¼€ì¤„ë§
- [ ] **ë°°í„°ë¦¬ ëª¨ë‹ˆí„°ë§**
  - [ ] ë°°í„°ë¦¬ ë ˆë²¨ ì¶”ì 
  - [ ] ì €ë°°í„°ë¦¬ ì•Œë¦¼
  - [ ] ì¶©ì „ í•„ìš” ì˜ˆì¸¡

- [ ] **ì¶©ì „ ìŠ¤ì¼€ì¤„ëŸ¬**
  - [ ] ì¶©ì „ì†Œ ê´€ë¦¬
  - [ ] ì¶©ì „ ëŒ€ê¸°ì—´
  - [ ] ì¶©ì „ ì‹œê°„ ìµœì í™”

#### 9ï¸âƒ£ ì¹´ì˜¤ìŠ¤ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸
- [ ] **ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤ êµ¬í˜„**
  - [ ] MASS_FAILURE (30% ë¡œë´‡ ê³ ì¥)
  - [ ] NETWORK_PARTITION (í†µì‹  ë‘ì ˆ)
  - [ ] TRAFFIC_SPIKE (ëŒ€ëŸ‰ ìš”ì²­)
  - [ ] CHARGING_STATION_FAILURE (ì¶©ì „ì†Œ ê³ ì¥)

- [ ] **ë³µêµ¬ ë¡œì§ ê²€ì¦**
  - [ ] Failover ë™ì‘ í™•ì¸
  - [ ] ì‘ì—… ì¬ë¶„ë°° í™•ì¸
  - [ ] ë°ì´í„° ì¼ê´€ì„± ê²€ì¦

#### ğŸ”Ÿ ì„±ëŠ¥ ì¸¡ì •/íŠœë‹
- [ ] **ë²¤ì¹˜ë§ˆí¬ ì„¤ì •**
  - [ ] JMH ë²¤ì¹˜ë§ˆí¬ ì‘ì„±
  - [ ] ì‘ë‹µ ì‹œê°„ ì¸¡ì •
  - [ ] TPS (Throughput) ì¸¡ì •

- [ ] **ìµœì í™”**
  - [ ] Hot Path ì§€ì—°ì‹œê°„ ìµœì†Œí™”
  - [ ] DB ì¿¼ë¦¬ ìµœì í™”
  - [ ] ìºì‹œ íˆíŠ¸ìœ¨ ê°œì„ 
  - [ ] ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”

---

## ğŸ“ ì‘ì—… ìš°ì„ ìˆœìœ„ ì œì•ˆ

Phase 2ëŠ” ë²”ìœ„ê°€ í¬ë¯€ë¡œ, ë‹¤ìŒ ìˆœì„œë¡œ ì§„í–‰ì„ ì œì•ˆí•©ë‹ˆë‹¤:

### ğŸ¯ 1ë‹¨ê³„: í•µì‹¬ ì¸í”„ë¼ (Week 5 ì „ë°˜)
```
ìš°ì„ ìˆœìœ„: P0 (í•„ìˆ˜)
ê¸°ê°„: 2-3ì¼

1. Unified Gateway ì¸í„°í˜ì´ìŠ¤ ì„¤ê³„
2. Hot/Warm/Cold Path ê¸°ë³¸ êµ¬ì¡°
3. Kafka ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼ ê¸°ë³¸ êµ¬í˜„
4. Redis ìºì‹œ ê¸°ë³¸ êµ¬ì¡°
```

### ğŸ¯ 2ë‹¨ê³„: ì´ë²¤íŠ¸ ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ (Week 5 í›„ë°˜)
```
ìš°ì„ ìˆœìœ„: P0 (í•„ìˆ˜)
ê¸°ê°„: 2-3ì¼

1. Kafka Producer/Consumer êµ¬í˜„
2. ì´ë²¤íŠ¸ ìˆ˜ì§‘ ë° ë°œí–‰
3. í† í”½ ë° ìŠ¤í‚¤ë§ˆ ì •ì˜
4. ì—ëŸ¬ í•¸ë“¤ë§
```

### ğŸ¯ 3ë‹¨ê³„: ìƒíƒœ ê´€ë¦¬ (Week 6 ì „ë°˜)
```
ìš°ì„ ìˆœìœ„: P1 (ì¤‘ìš”)
ê¸°ê°„: 2ì¼

1. Redis ìºì‹œ ë ˆì´ì–´ ì™„ì„±
2. ë¡œë´‡/ì¥ì¹˜ ìƒíƒœ ìºì‹±
3. ìºì‹œ ë¬´íš¨í™” ë¡œì§
```

### ğŸ¯ 4ë‹¨ê³„: ì‘ì—… ë¶„ë°° ì‹œìŠ¤í…œ (Week 6 í›„ë°˜ ~ Week 7)
```
ìš°ì„ ìˆœìœ„: P0 (í•„ìˆ˜)
ê¸°ê°„: 3-4ì¼

1. ì‘ì—… í ë° ë¶„ë°° ì•Œê³ ë¦¬ì¦˜
2. PathFinder ì„œë¹„ìŠ¤ í†µí•©
3. ì¶©ì „ ìŠ¤ì¼€ì¤„ë§
```

### ğŸ¯ 5ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ë° ìµœì í™” (Week 8)
```
ìš°ì„ ìˆœìœ„: P1 (ì¤‘ìš”)
ê¸°ê°„: 3-4ì¼

1. ì¹´ì˜¤ìŠ¤ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸
2. ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬
3. íŠœë‹ ë° ìµœì í™”
```

---

## â“ í˜‘ì˜ í•„ìš” ì‚¬í•­

### 1. ì‘ì—… ì‹œì‘ ìˆœì„œ
ê° ë‹¨ê³„ê°€ 2-4ì¼ ì •ë„ ì†Œìš”ë  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤. ì–´ë–¤ ë‹¨ê³„ë¶€í„° ì‹œì‘í• ê¹Œìš”?

**ì¶”ì²œ:** 1ë‹¨ê³„ (í•µì‹¬ ì¸í”„ë¼)ë¶€í„° ì‹œì‘

### 2. êµ¬í˜„ ë²”ìœ„ ì¡°ì •
ì¼ë¶€ ê¸°ëŠ¥ì€ Phase 3 ì´í›„ë¡œ ë¯¸ë£° ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- ì¹´ì˜¤ìŠ¤ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ â†’ Phase 5ë¡œ ì´ë™ ê°€ëŠ¥
- ì„±ëŠ¥ íŠœë‹ â†’ í•„ìš”ì‹œ ì¶”ê°€ ê°€ëŠ¥
- ê³ ê¸‰ ë¶„ë°° ì•Œê³ ë¦¬ì¦˜ â†’ ê¸°ë³¸ Round-Robinë§Œ ìš°ì„  êµ¬í˜„

### 3. ê¸°ìˆ  ìŠ¤íƒ í™•ì¸
- **Kafka:** Embedded Kafka vs Docker Kafka?
- **Redis:** Redis Standalone vs Redis Cluster?
- **ì§ë ¬í™”:** JSON vs Avro?

---

## ğŸ“ ì§„í–‰ ë¡œê·¸

### 2026-01-16

#### 00:00 - Phase 2 ê³„íš ìˆ˜ë¦½
- Phase 2 ì‘ì—… ë²”ìœ„ ë¶„ì„ ì™„ë£Œ
- PHASE2_PROGRESS.md ë¬¸ì„œ ìƒì„±
- 5ë‹¨ê³„ ì‘ì—… ê³„íš ìˆ˜ë¦½
- ì‚¬ìš©ì í˜‘ì˜ ì™„ë£Œ â†’ 1ë‹¨ê³„ë¶€í„° ìˆœì°¨ì  ì§„í–‰ ê²°ì •

#### 01:00 - 1-1. Gateway ë„ë©”ì¸ ëª¨ë¸ ì„¤ê³„ ì™„ë£Œ âœ…

**ìƒì„± íŒŒì¼:**
- `/backend/safetyhub-core/src/main/java/com/safetyhub/core/gateway/Protocol.java`
- `/backend/safetyhub-core/src/main/java/com/safetyhub/core/gateway/MessageType.java`
- `/backend/safetyhub-core/src/main/java/com/safetyhub/core/gateway/MessageEnvelope.java`
- `/backend/safetyhub-core/src/test/java/com/safetyhub/core/gateway/MessageEnvelopeTest.java`

**êµ¬í˜„ ë‚´ìš©:**

1. **Protocol Enum (í”„ë¡œí† ì½œ íƒ€ì…)**
   - MQTT: IoT ì¥ì¹˜ (SafetyKit, LifeGuard)
   - WEBSOCKET: ì‹¤ì‹œê°„ ì–‘ë°©í–¥ í†µì‹  (ë¡œë´‡, ëŒ€ì‹œë³´ë“œ)
   - REST: ì¼ë°˜ API í˜¸ì¶œ
   - GRPC: ê³ ì„±ëŠ¥ ë‚´ë¶€ ì„œë¹„ìŠ¤ í†µì‹  (ë¯¸ë˜ í™•ì¥)
   - SIMULATOR: ê°œë°œ/í…ŒìŠ¤íŠ¸ í™˜ê²½

2. **MessageType Enum (ë©”ì‹œì§€ íƒ€ì…)**
   - COMMAND: ì™¸ë¶€ â†’ ë‚´ë¶€ ëª…ë ¹ (ì„¤ë¹„ ì œì–´, ì‘ì—… ì§€ì‹œ)
   - EVENT: ì´ë²¤íŠ¸ ì•Œë¦¼ (ì„¼ì„œ ë°ì´í„°, ìƒíƒœ ë³€ê²½)
   - QUERY: ìƒíƒœ ì¡°íšŒ ìš”ì²­
   - RESPONSE: ì¿¼ë¦¬ ì‘ë‹µ
   - HEARTBEAT: ì—°ê²° ìœ ì§€ ë° ìƒì¡´ í™•ì¸

3. **MessageEnvelope (í†µí•© ë©”ì‹œì§€ ë´‰íˆ¬)**
   - ë¶ˆë³€ ê°ì²´ ì„¤ê³„ (final fields, Builder íŒ¨í„´)
   - í•„ìˆ˜ í•„ë“œ: messageType, protocol, source, priority, payload
   - ì„ íƒ í•„ë“œ: messageId (ìë™ ìƒì„±), correlationId, target, timestamp (ìë™ ìƒì„±), metadata
   - í˜ì´ë¡œë“œ í¬ê¸° ì œí•œ: 1MB (DoS ê³µê²© ë°©ì§€)
   - Hot/Warm/Cold Path íŒë³„ ë©”ì„œë“œ
   - ì‘ë‹µ ë©”ì‹œì§€ ìƒì„± í—¬í¼ ë©”ì„œë“œ

**ë³´ì•ˆ ì¡°ì¹˜:**
- âœ… ì…ë ¥ ê²€ì¦: í•„ìˆ˜ í•„ë“œ null ì²´í¬, ë¹ˆ ë¬¸ìì—´ ê²€ì¦
- âœ… í˜ì´ë¡œë“œ í¬ê¸° ì œí•œ (1MB) - DoS ë°©ì§€
- âœ… ë¶ˆë³€ ê°ì²´ (final fields) - ìŠ¤ë ˆë“œ ì•ˆì „ì„±
- âœ… ë¯¼ê°ì •ë³´ ë¡œê¹… ë°©ì§€ (`@ToString(exclude = "payload")`)
- âœ… ë¹Œë” íŒ¨í„´ìœ¼ë¡œ í•„ìˆ˜ í•„ë“œ ê°•ì œ
- âœ… ë©”ì‹œì§€ ID ìë™ ìƒì„± (UUID)

**í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€:**
- ì´ 24ê°œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±
- ì •ìƒ ìƒì„± í…ŒìŠ¤íŠ¸ (2ê°œ)
- í•„ìˆ˜ í•„ë“œ ê²€ì¦ í…ŒìŠ¤íŠ¸ (6ê°œ)
- ë³´ì•ˆ ê²€ì¦ í…ŒìŠ¤íŠ¸ (2ê°œ)
- ì‘ë‹µ ë©”ì‹œì§€ ìƒì„± í…ŒìŠ¤íŠ¸ (1ê°œ)
- ìœ í‹¸ë¦¬í‹° ë©”ì„œë“œ í…ŒìŠ¤íŠ¸ (7ê°œ)
- ë‹¤ì–‘í•œ í”„ë¡œí† ì½œ í…ŒìŠ¤íŠ¸ (3ê°œ)

#### 02:00 - 1-2. ProtocolAdapter ì¸í„°í˜ì´ìŠ¤ ì •ì˜ ì™„ë£Œ âœ…

**ìƒì„± íŒŒì¼:**
- `/backend/safetyhub-core/src/main/java/com/safetyhub/core/gateway/ProtocolAdapter.java`
- `/backend/safetyhub-core/src/main/java/com/safetyhub/core/gateway/AbstractProtocolAdapter.java`
- `/backend/safetyhub-core/src/main/java/com/safetyhub/core/gateway/MessageConversionException.java`
- `/backend/safetyhub-adapter/adapter-simulator/src/main/java/com/safetyhub/adapter/simulator/SimulatorProtocolAdapter.java`
- `/backend/safetyhub-core/src/test/java/com/safetyhub/core/gateway/ProtocolAdapterTest.java`

**êµ¬í˜„ ë‚´ìš©:**

1. **ProtocolAdapter ì¸í„°í˜ì´ìŠ¤ (Port & Adapter íŒ¨í„´ì˜ í•µì‹¬)**
   - `toEnvelope(T message)`: í”„ë¡œí† ì½œë³„ ë©”ì‹œì§€ â†’ MessageEnvelope ë³€í™˜
   - `fromEnvelope(MessageEnvelope envelope)`: MessageEnvelope â†’ í”„ë¡œí† ì½œë³„ ë©”ì‹œì§€ ë³€í™˜
   - `getSupportedProtocol()`: ì§€ì› í”„ë¡œí† ì½œ íƒ€ì… ë°˜í™˜
   - `supports(T message)`: ë©”ì‹œì§€ ì§€ì› ì—¬ë¶€ í™•ì¸

2. **AbstractProtocolAdapter ì¶”ìƒ í´ë˜ìŠ¤**
   - ProtocolAdapter êµ¬í˜„ì„ ìœ„í•œ ê¸°ë³¸ ê¸°ëŠ¥ ì œê³µ
   - ê³µí†µ ê²€ì¦ ë¡œì§ (null ì²´í¬, í˜ì´ë¡œë“œ í¬ê¸° ê²€ì¦)
   - ì˜ˆì™¸ ì²˜ë¦¬ ë° ë˜í•‘ (MessageConversionException)
   - í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´: `doToEnvelope()`, `doFromEnvelope()` êµ¬í˜„ ìœ„ì„

3. **MessageConversionException**
   - ë©”ì‹œì§€ ë³€í™˜ ì‹¤íŒ¨ ì‹œ ë°œìƒí•˜ëŠ” ì˜ˆì™¸
   - í”„ë¡œí† ì½œ ì •ë³´ í¬í•¨
   - ì›ì¸ ì˜ˆì™¸ ì²´ì´ë‹

4. **SimulatorProtocolAdapter (ì˜ˆì œ êµ¬í˜„)**
   - JSON ê¸°ë°˜ ë©”ì‹œì§€ ë³€í™˜
   - Jackson ObjectMapper ì‚¬ìš©
   - ê°œë°œ/í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ì‚¬ìš©

**ë³´ì•ˆ ì¡°ì¹˜:**
- âœ… ì…ë ¥ ê²€ì¦: null ì²´í¬, ë©”ì‹œì§€ íƒ€ì… ê²€ì¦
- âœ… í˜ì´ë¡œë“œ í¬ê¸° ê²€ì¦ (1MB ì œí•œ)
- âœ… ì˜ˆì™¸ ì²˜ë¦¬: ë¯¼ê°ì •ë³´ ë…¸ì¶œ ë°©ì§€
- âœ… í”„ë¡œí† ì½œ ì¼ì¹˜ ê²€ì¦
- âœ… í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´ìœ¼ë¡œ ì•ˆì „í•œ í™•ì¥
- âœ… final ë©”ì„œë“œë¡œ ê²€ì¦ ë¡œì§ ìš°íšŒ ë°©ì§€

**ì„¤ê³„ ì›ì¹™:**
- Port & Adapter íŒ¨í„´: CoreëŠ” Adapterë¥¼ ëª¨ë¦„
- ë‹¨ë°©í–¥ ì˜ì¡´ì„±: Adapter â†’ Core
- ëŠìŠ¨í•œ ê²°í•©: í”„ë¡œí† ì½œ ë³€ê²½ì´ Coreì— ì˜í–¥ ì—†ìŒ
- í™•ì¥ ê°€ëŠ¥: ìƒˆ í”„ë¡œí† ì½œ ì¶”ê°€ ì‹œ ì¸í„°í˜ì´ìŠ¤ë§Œ êµ¬í˜„

**í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€:**
- ì´ 20ê°œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±
- toEnvelope í…ŒìŠ¤íŠ¸ (3ê°œ)
- fromEnvelope í…ŒìŠ¤íŠ¸ (3ê°œ)
- í”„ë¡œí† ì½œ ì§€ì› í…ŒìŠ¤íŠ¸ (2ê°œ)
- supports í…ŒìŠ¤íŠ¸ (2ê°œ)
- í˜ì´ë¡œë“œ í¬ê¸° ê²€ì¦ (2ê°œ)
- MessageConversionException í…ŒìŠ¤íŠ¸ (4ê°œ)

#### 03:00 - 1-3. MessageRouter ê°œì„  (Hot/Warm/Cold Path ë¶„ë¦¬) ì™„ë£Œ âœ…

**ìƒì„± íŒŒì¼:**
- `/backend/safetyhub-core/src/main/java/com/safetyhub/core/gateway/MessageHandler.java`
- `/backend/safetyhub-core/src/main/java/com/safetyhub/core/gateway/MessageHandlingException.java`
- `/backend/safetyhub-gateway/src/main/java/com/safetyhub/gateway/ImprovedMessageRouter.java`
- `/backend/safetyhub-gateway/src/main/java/com/safetyhub/gateway/handler/HotPathHandler.java`
- `/backend/safetyhub-gateway/src/main/java/com/safetyhub/gateway/handler/WarmPathHandler.java`
- `/backend/safetyhub-gateway/src/main/java/com/safetyhub/gateway/handler/ColdPathHandler.java`
- `/backend/safetyhub-gateway/src/test/java/com/safetyhub/gateway/ImprovedMessageRouterTest.java`

**êµ¬í˜„ ë‚´ìš©:**

1. **MessageHandler ì¸í„°í˜ì´ìŠ¤**
   - í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ (`@FunctionalInterface`)
   - `handle(MessageEnvelope envelope)`: ë©”ì‹œì§€ ì²˜ë¦¬ ë©”ì„œë“œ
   - Hot/Warm/Cold Path í•¸ë“¤ëŸ¬ ì¶”ìƒí™”

2. **MessageHandlingException**
   - ë©”ì‹œì§€ ì²˜ë¦¬ ì‹¤íŒ¨ ì‹œ ë°œìƒí•˜ëŠ” ì»¤ìŠ¤í…€ ì˜ˆì™¸
   - Path ì •ë³´ í¬í•¨ (HOT/WARM/COLD)
   - ì›ì¸ ì˜ˆì™¸ ì²´ì´ë‹

3. **ImprovedMessageRouter (í•µì‹¬)**
   - ìš°ì„ ìˆœìœ„ ê¸°ë°˜ ë©”ì‹œì§€ ë¼ìš°íŒ…
   - Hot Path (CRITICAL, HIGH): ë™ê¸°, < 10ms
   - Warm Path (NORMAL): ë™ê¸°, < 500ms
   - Cold Path (LOW): ë¹„ë™ê¸°, ì‘ë‹µ ì‹œê°„ ì œì•½ ì—†ìŒ
   - ì „ëµ íŒ¨í„´: í•¸ë“¤ëŸ¬ êµì²´ ê°€ëŠ¥
   - ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§: ëª©í‘œ ì‹œê°„ ì´ˆê³¼ ê²½ê³  ë¡œê¹…

4. **HotPathHandler (ê¸´ê¸‰ ì²˜ë¦¬)**
   - ê¸´ê¸‰ ì •ì§€, ì¶©ëŒ íšŒí”¼, 119 ì‹ ê³ 
   - In-Memory ì²˜ë¦¬ (Redis)
   - DB ì ‘ê·¼ ìµœì†Œí™”
   - ë¹ ë¥¸ ì‹¤íŒ¨ (Fail-Fast)

5. **WarmPathHandler (ì¼ë°˜ ì²˜ë¦¬)**
   - íƒœìŠ¤í¬ ë¶„ë°°, ê²½ë¡œ ê³„ì‚°, ì•Œë¦¼ ë°œì†¡
   - DB ì½ê¸°/ì“°ê¸° í—ˆìš©
   - Redis ìºì‹œ í™œìš©
   - ë³µì¡í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

6. **ColdPathHandler (ë°°ì¹˜ ì²˜ë¦¬)**
   - ë¡œê·¸ ì €ì¥, í†µê³„ ë¶„ì„, ë¦¬í¬íŒ…
   - ë¹„ë™ê¸° ì²˜ë¦¬
   - ë°°ì¹˜ ìµœì í™”
   - ì—ëŸ¬ê°€ ë©”ì¸ í”Œë¡œìš°ì— ì˜í–¥ ì—†ìŒ

**ë³´ì•ˆ ì¡°ì¹˜:**
- âœ… ì…ë ¥ ê²€ì¦: null ì²´í¬, í•¸ë“¤ëŸ¬ ê²€ì¦
- âœ… ì˜ˆì™¸ ì²˜ë¦¬: ë¯¼ê°ì •ë³´ ë…¸ì¶œ ë°©ì§€
- âœ… ìŠ¤ë ˆë“œ ì•ˆì „ì„±: ë¶ˆë³€ ê°ì²´, ExecutorService
- âœ… ë¦¬ì†ŒìŠ¤ ê´€ë¦¬: shutdown() ë©”ì„œë“œë¡œ ì •ë¦¬
- âœ… ì—ëŸ¬ ê²©ë¦¬: Cold Path ì—ëŸ¬ê°€ ë©”ì¸ í”Œë¡œìš°ì— ì˜í–¥ ì—†ìŒ

**ì„¤ê³„ íŒ¨í„´:**
- ì „ëµ íŒ¨í„´: Pathë³„ í•¸ë“¤ëŸ¬ êµì²´ ê°€ëŠ¥
- í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´: ê³µí†µ ë¡œì§ ì¬ì‚¬ìš©
- ì˜ì¡´ì„± ì£¼ì…: ìƒì„±ì ì£¼ì…ìœ¼ë¡œ ëŠìŠ¨í•œ ê²°í•©

**ì„±ëŠ¥ ìµœì í™”:**
- Hot Path: In-Memory ì²˜ë¦¬, ìµœì†Œ ë¡œì§
- Warm Path: DB ì ‘ê·¼ í—ˆìš©, ìºì‹œ í™œìš©
- Cold Path: ë¹„ë™ê¸° ì²˜ë¦¬, ë³„ë„ ìŠ¤ë ˆë“œ í’€
- ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§: ëª©í‘œ ì‹œê°„ ì´ˆê³¼ ê²½ê³ 

**í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€:**
- ì´ 18ê°œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±
- Hot Path ë¼ìš°íŒ… (3ê°œ)
- Warm Path ë¼ìš°íŒ… (2ê°œ)
- Cold Path ë¼ìš°íŒ… (2ê°œ)
- ì…ë ¥ ê²€ì¦ (4ê°œ)
- ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (2ê°œ)
- MessageHandlingException (4ê°œ)

---

## ğŸ”— ì°¸ê³  ë¬¸ì„œ

- [DEVROADMAP.md](./DEVROADMAP.md) - ì „ì²´ ê°œë°œ ë¡œë“œë§µ
- [PHASE1_PROGRESS.md](./PHASE1_PROGRESS.md) - Phase 1 ì§„í–‰ ê¸°ë¡
- [ACHITECTURE.md](./ACHITECTURE.md) - ì•„í‚¤í…ì²˜ ì„¤ê³„
- [TECH_INFO.md](./TECH_INFO.md) - ê¸°ìˆ  ìŠ¤íƒ ì •ë³´

---

**ë¬¸ì„œ ë²„ì „:** v1.0
**ìµœì¢… ì—…ë°ì´íŠ¸:** 2026-01-16 00:00
